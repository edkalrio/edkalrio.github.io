<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta name="robots" content="nofollow">
  <title>Mi router-consola - Lunatic Geek</title>
  <meta property="og:title" content="Mi router-consola - Lunatic Geek" />
  <meta name="twitter:title" content="Mi router-consola - Lunatic Geek" />
  <meta name="description" content="La nueva generación de consolas ha llegado al mercado y todos los gamers están sobreexcitados, decidiendo si comprar la PS4, Xbox One o ambas si sus bolsillos se lo permiten. Ciertamente, la nueva generación es muy interesante por muchos motivos pero no es lo suficientemente geek. Por suerte, en este blog siempre apostamos por las soluciones absurdas para problemas que no existen y así es como llegamos a la conclusión de que teníamos que fabricar nuestra propia consola con el frikismo como leitmotiv.">
  <meta property="og:description" content="La nueva generación de consolas ha llegado al mercado y todos los gamers están sobreexcitados, decidiendo si comprar la PS4, Xbox One o ambas si sus bolsillos se lo permiten. Ciertamente, la nueva generación es muy interesante por muchos motivos pero no es lo suficientemente geek. Por suerte, en este blog siempre apostamos por las soluciones absurdas para problemas que no existen y así es como llegamos a la conclusión de que teníamos que fabricar nuestra propia consola con el frikismo como leitmotiv.">
  <meta name="twitter:description" content="La nueva generación de consolas ha llegado al mercado y todos los gamers están sobreexcitados, decidiendo si comprar la PS4, Xbox One o ambas si sus bolsillos se lo permiten. Ciertamente, la nueva …">
  <meta name="author" content="edkalrio"/>
  <link rel="icon" type="image/png" href="https://lunaticgeek.com/favicon.png" />
  <meta property="og:site_name" content="Lunatic Geek" />
  <meta property="og:url" content="/2013-12-05-mi-router-consola/" />
  <meta property="og:type" content="article" />
  
  <meta property="og:image" content="https://lunaticgeek.com/lunaticgeek_2to1.png" />
  <meta name="twitter:image" content="https://lunaticgeek.com/lunaticgeek_2to1.png" />
  
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="generator" content="WIT" />
  <link rel="stylesheet" href="/css/style.css" media="all" />
  <link rel="stylesheet" href="/css/syntax.css" media="all" />
  <link rel="stylesheet" href="/css/custom.css" media="all" />
  



</head>

<body>

<header class="site-header">
  <h1 class="site-title"><a href="/"><img src="/lunaticgeek.webp"></a></h1>
	
  <nav class="site-navi">
    <ul class="site-navi-items">
      <li class="site-navi-item-tags"><a href="/tags/" title="Tags">Tags</a></li>
      <li class="site-navi-item-archives"><a href="/archives/" title="Archivo">Archivo</a></li>
      <li class="site-navi-item-about"><a href="/about/" title="Yo">Yo</a></li>
    </ul>
  </nav>
</header>
<hr class="site-header-bottom">

	<div class="main" role="main">
		<article class="article">
			
			
			<h1 class="article-title">Mi router-consola</h1>
			
			<hr class="article-title-bottom">
			<ul class="article-meta">
				<li class="article-meta-date"><time>2013-12-05</time></li>
				<li class="article-meta-tags">
					<a href="/tags/linux/">
						<b>#</b>Linux
					</a> 
				</li>
				<li class="article-meta-tags">
					<a href="/tags/ps4/">
						<b>#</b>ps4
					</a> 
				</li>
				<li class="article-meta-tags">
					<a href="/tags/xbox/">
						<b>#</b>xbox
					</a> 
				</li>
				<div>
    <a href="https://twitter.com/share" class="twitter-share-button">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
</div>
			</ul>
			
			<div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://www.tp-link.es/resources/images/products/large/TL-WR841N_8.0-03.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://www.tp-link.es/resources/images/products/large/TL-WR841N_8.0-03.jpg" height="400" width="376" /></a></div>La nueva generación de consolas ha llegado al mercado y todos los gamers están sobreexcitados, decidiendo si comprar la PS4, Xbox One o ambas si sus bolsillos se lo permiten. Ciertamente, la nueva generación es muy interesante por muchos motivos pero no es lo suficientemente geek. Por suerte, en este blog siempre apostamos por las soluciones absurdas para problemas que no existen y así es como llegamos a la conclusión de que teníamos que fabricar nuestra propia consola con el frikismo como <i>leitmotiv</i>.<br /><br /></div><div style="text-align: justify;">Todos los fieles seguidores de este blog conocen nuestro experimento de refrigeración por inmersión en aceite de la Xbox 360 pero esta vez queríamos ir más allá, transformando mi router en una "flamante" consola.<br /><br /><a name='more'></a></div><div style="text-align: justify;">Cuando la gente normal ve un router no piensa en lo que realmente es. Un ordenador con Linux. En mi caso es un TP-Link TL-WR841n v.8.4 con un procesador de 535Mhz, 32MB de RAM y un almacenamiento de 4MiB. Es un router de gama baja, de 20€, nada espectacular pero lo suficiente como para lanzar algún juego desde la terminal.<br /><br /></div><div style="text-align: justify;"><a href="http://www.tp-link.es/resources/images/products/large/TL-WR841N_8.0-04.jpg" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" src="http://www.tp-link.es/resources/images/products/large/TL-WR841N_8.0-04.jpg" height="200" width="186" /></a>Voy a explicar todo el proceso de instalación de un videojuego en mi router y de paso, criticar algunos tutoriales sobre compilación cruzada para OpenWRT que he visto en la web y que no me han gustado demasiado. Pero antes una advertencia: Este tutorial no es extrapolable. Sus métodos no se pueden utilizar exactamente para compilar cualquier otro programa, en otro modelo de router, ni siquiera en versiones anteriores del mismo modelo. Con esto quiero decir que si sigues al pie de la letra el tutorial, te vas a cargar el router y no es seguro que puedas arreglarlo...<br /><br /></div><div style="text-align: justify;">Lo primero que hay que hacer es descargar OpenWRT, el sistema operativo para routers que vamos a usar como base para correr los videojuegos. (pongo el prompt completo para que nadie se pierda cuando empiecen las conexiones.)</div><pre style="text-align: justify;">edkalrio@alexandra:~$ wget http://downloads.openwrt.org/attitude_adjustment/12.09/ar71xx/generic/openwrt-ar71xx-generic-tl-wr841n-v8-squashfs-factory.bin</pre><div style="text-align: justify;">Hay que conectarse con el router por la puerta de enlace (192.168.0.1) desde un navegador web e instalar el firmware como si fuera una actualización normal del sistema original.<br /><br />También se descarga, extrae y descomprime el toolchain, un conjunto de herramientas que nos permitirán hacer una compilación cruzada del código. En <a href="http://www.josevelasco.org/2012/01/13/compilacion-openwrt/" rel="nofollow" target="_blank">otros tutoriales</a> se complican la vida innecesariamente compilándolo cuando ya vienen preparados si buscamos un poco por el servidor de OpenWrt.</div><pre><div style="text-align: justify;"><br />edkalrio@alexandra:~$ wget http://downloads.openwrt.org/attitude_adjustment/12.09/ar71xx/generic/OpenWrt-Toolchain-ar71xx-for-mips_r2-gcc-4.6-linaro_uClibc-0.9.33.2.tar.bz2</div><br /><div style="text-align: justify;"><br />edkalrio@alexandra:~$ tar -xjf OpenWrt-Toolchain-ar71xx-for-mips_r2-gcc-4.6-linaro_uClibc-0.9.33.2.tar.bz2</div><br /></pre><div style="text-align: justify;">Estas descargas se podían haber hecho en el entorno gráfico pero como casi todo el tutorial es para la terminal, no cuesta nada descargarlo con wget.<br /><br /></div><div style="text-align: justify;">El juego que he elegido para instalar en el router es, como no podía ser de otro modo, los quinquiluñes. No solo porque es el juego que programamos&nbsp;<a class="g-profile" href="https://plus.google.com/111707027408676510631" target="_blank">+Ruben Velasco</a>&nbsp;y yo sino porque su tamaño, estructura monolítica y sin bibliotecas externas ni apenas punteros hace que la compilación sea mucho más fácil de lo que otros <a href="http://giovanni.wordpress.com/2011/01/23/how-to-cross-compile-a-c-program-for-openwrt/" rel="nofollow" target="_blank">tutoriales</a> nos quieren hacer creer. Obtenemos el código de github y ya que estamos lo movemos y cambiamos el nombre porque a Rubén le gustan los nombres descriptivos aunque sean tan largos.</div><pre><div style="text-align: justify;"><br />edkalrio@alexandra:~$ git clone https://github.com/ruvelro/Quinquilunes.git</div><br /><div style="text-align: justify;"><br />edkalrio@alexandra:~$ cp ~/Quinquilunes/quinquilunes.c ~/qq.c</div><br /></pre><div style="text-align: justify;">Lo esencial de este tutorial es la compilación cruzada. Como el router no tiene capacidad para albergar un compilador propio, hay que construir los programas desde otro ordenador que obviamente tendrá una arquitectura distinta. El toolchain proporciona las funciones necesarias para compilar código para MIPS desde nuestro procesador AMD64 y muchísimo más rápido que si usáramos el procesador del router. Para utilizar estas herramientas, hay otros <a href="http://taiksonprojects.blogspot.com.es/2012/02/compilacion-cruzada-con-openwrt-cross.html" rel="nofollow" target="_blank">tutoriales</a> que crean asignan variables de entorno para enlazar estas herramientas con GCC pero no vale la pena complicarse la vida con una solución que, tal y como la plantean solo sirve para una sesión. Lo mejor es utilizar este sencillo comando para compilar nuestro código en C. Los parámetros del script son los mismos que podemos usar en GCC, por si se quisiera añadir alguno.</div><pre style="text-align: justify;">edkalrio@alexandra:~$ sh ~/OpenWrt-Toolchain-ar71xx-for-mips_r2-gcc-4.6-linaro_uClibc-0.9.33.2/toolchain-mips_r2_gcc-4.6-linaro_uClibc-0.9.33.2/bin/mips-openwrt-linux-uclibc-gcc -o qq qq.c</pre><div style="text-align: justify;">Ahora que ya tenemos el binario preparado, hay que llevarlo al router. Las soluciones que se plantean en aquellos tutoriales, a través de servidores FTP son bastante enrevesadas y suponen que previamente tengamos montado uno de esos servidores y tener configurado el router para poder acceder a internet, cosa que yo todavía no he hecho porque solo quería que se pudiera usar como consola.<br /><br /></div><div style="text-align: justify;">Primero hay que conectarse al router por telnet. No uso telnet por la misma razón por la que no uso Whatsapp así que intentaré estar lo menos posible. Simplemente le ponemos una contraseña y salimos (yo además aproveché para cambiar la puerta de enlace pero eso no tiene que ver con este tutorial sino con la configuración del router como tal) para volver a conectarnos, esta vez sí, por SSH.</div><pre>edkalrio@alexandra:~$ telnet root@192.168.1.1<br /><br />root@OpenWrt~# passwd<br /><br />root@OpenWrt~# exit<br /><br />edkalrio@alexandra:~$ ssh root@192.168.1.1</pre><div style="text-align: justify;">Entonces, la solución al problema de la instalación es hacer un copia-pega de toda la vida pero esta vez de forma remota a través de SSH. Hay que tener cuidado porque no estamos trabajando con un ordenador con 1TB de disco duro sino con solo 4MiB de almacenamiento. Por suerte, el sistema operativo ocupa 3932160B y el binario de los quinquiluñes 16184B, por lo que todavía nos sobran 245960B para instalar más juegos.</div><div style="text-align: justify;"><pre style="text-align: justify;">root@OpenWrt~# scp edkalrio@192.168.0.101:/home/edkalrio/qq /bin</pre>Como lo hemos copiado al directorio /bin no hace falta moverse hasta ahí para invocar los programas que hayamos instalado. Ya solo queda pulsar qq para jugar a los quinquiluñes en nuestro router a través de una conexión SSH.</div><pre style="text-align: justify;">root@OpenWrt~# qq</pre><div style="text-align: justify;">Nos ha quedado una consola geek, retro y única para demostrar la versatilidad de Linux y la flexibilidad del código en ANSI-C. Para terminar voy a dejar un par de capturas de pantalla de algunas partidas desde mi estación de trabajo y mi iPod. Si tuviera una IP estática o DDNS se podría jugar desde cualquier lugar. Solo se tendría que abrir el puerto 22 para permitir el acceso online.</div><div style="text-align: justify;"><br />Quizás otro día le haga overclock...</div><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-NurPmSFO4KM/UppY8Y-r2bI/AAAAAAAADKY/yhFV3KWv9J4/s1600/IMG_0170.PNG" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" src="http://1.bp.blogspot.com/-NurPmSFO4KM/UppY8Y-r2bI/AAAAAAAADKY/yhFV3KWv9J4/s1600/IMG_0170.PNG" height="400" width="266" /></a><a href="http://2.bp.blogspot.com/-nH5zuplX7ZM/Up4R_RgGQ6I/AAAAAAAADLQ/UwDNzZBRPy4/s1600/edkalrio@alexandra:+~_014.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-nH5zuplX7ZM/Up4R_RgGQ6I/AAAAAAAADLQ/UwDNzZBRPy4/s1600/edkalrio@alexandra:+~_014.png" height="400" width="252" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div></div>
		</article>

	</div>


<div class="site-footer">
  <div class="copyright">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
      <img src="/creative-commons.svg" class="fa"></img>
    </a>
    RW Labs 2020</div>
  <ul class="site-footer-items">
    
    <li class="site-footer-item-rsslink">
      <a href="https://feeds.feedburner.com/lunaticgeek/Hmrm" type="application/rss+xml" target="_blank" title="RSS">
        
        <img src="/rss.svg" class="fa">
      </a>
    </li>
    <li>
      <a href="http://mdoovnnifyqyl6jmgdibrsbq6tpk22npjhntsjkwvh7syrxgepxdejad.onion">
        <img src="/tor.svg" class="fa"></img>
      </a>
    </li>
  </ul>
  <div class="powerdby">
    Powered by WIT, based on <a href="https://gohugo.io/">Hugo</a> and <a href="https://github.com/taikii/whiteplain">Whiteplain</a>
  </div>
</div>



</body>
</html>
